module Game.Map exposing (..)

import Config
import Dict exposing (Dict)
import Entity exposing (Entity(..))
import Game exposing (Game)
import Game.Build exposing (BuildingBlock(..))


get : ( Int, Int ) -> Game
get pos =
    dict
        |> Dict.get pos
        |> Maybe.withDefault Dict.empty
        |> Dict.toList
        |> Game.Build.fromBlocks
            { doors =
                getDoors pos
            }


getDoors : ( Int, Int ) -> List ( ( Int, Int ), { room : ( Int, Int ) } )
getDoors ( x, y ) =
    [ ( ( x - 1, y ), ( -1, 2 ) )
    , ( ( x, y - 1 ), ( 2, -1 ) )
    , ( ( x + 1, y ), ( Config.roomSize, 2 ) )
    , ( ( x, y + 1 ), ( 2, Config.roomSize ) )
    ]
        |> List.filterMap
            (\( room, pos ) ->
                if dict |> Dict.member room then
                    Just ( pos, { room = room } )

                else
                    Nothing
            )


dict : Dict ( Int, Int ) (Dict ( Int, Int ) BuildingBlock)
dict =
    [ ( ( 0, 0 )
      , [ "ðŸ§±ðŸ§±â¬œðŸ§±ðŸ§±"
        , "ðŸ§±ðŸ§±â¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œâ¬œ"
        , "ðŸ§±â¬œâ¬œâ¬œâ¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
            |> Dict.insert ( Config.roomSize, 2 ) (EntityBlock LockedDoor)
      )
    , ( ( 1, 0 )
      , [ "ðŸ§±ðŸ§±ðŸ§±ðŸ§±ðŸ§±"
        , "ðŸ§±ðŸ§±â¬œâ¬œâ¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "â¬œâ¬œâ¬œâŒâŒ"
        , "âŒâŒâŒâŒâŒ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( 2, 0 )
      , [ "ðŸ§±â¬œâ¬œâŒâŒ"
        , "â¬œâ¬œâ¬œâŒâŒ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "âŒâ¬œâ¬œâŒâŒ"
        , "âŒâŒâŒâŒâŒ"
        ]
            |> Game.Build.fromEmojis
            |> Dict.insert ( Config.roomSize, 2 ) (EntityBlock LockedDoor)
      )
    , ( ( 3, 0 )
      , [ "âŒâŒâ¬œðŸ§ŠðŸ§Š"
        , "âŒâŒâ¬œâ¬œðŸ§Š"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "âŒâŒðŸ§Šâ¬œâ¬œ"
        , "âŒâŒâŒðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( 4, 0 )
      , [ "ðŸ§ŠðŸ§Šâ¬œâ¬œðŸ§Š"
        , "ðŸ§ŠðŸ§Šâ¬œâ¬œðŸ§Š"
        , "â¬œâ¬œâ¬œðŸ§ŠðŸ§Š"
        , "â¬œâ¬œðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
            |> Dict.insert ( Config.roomSize, 2 ) (EntityBlock LockedDoor)
      )
    , ( ( 5, 0 )
      , [ "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "â¬œâ¬œðŸ’Žâ¬œâ¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    ]
        ++ sokoBombLevels ( 0, -1 )
        ++ lavaLevels ( 2, -1 )
        ++ iceLevels ( 4, -1 )
        |> Dict.fromList


iceLevels : ( Int, Int ) -> List ( ( Int, Int ), Dict ( Int, Int ) BuildingBlock )
iceLevels ( x, y ) =
    [ ( ( x, y )
      , [ "ðŸ§±ðŸ§±ðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§±ðŸ§±ðŸ§±ðŸ§±ðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§±ðŸ§±ðŸ§±ðŸ§±"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§±ðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 1 )
      , [ "ðŸ§ŠðŸ§Šâ¬œðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "â¬œðŸ§ŠðŸ§ŠðŸ§Šâ¬œ"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§Šâ¬œðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 2 )
      , [ "ðŸ§ŠðŸ§±ðŸ§ŠðŸ§±ðŸ§Š"
        , "ðŸ§ŠðŸ§Šâ¬œðŸ§ŠðŸ§Š"
        , "â¬œðŸ§ŠðŸ§±ðŸ§Šâ¬œ"
        , "â¬œðŸ§Šâ¬œðŸ§Šâ¬œ"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 3 )
      , [ "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§±ðŸ§Š"
        , "ðŸ§±ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§±ðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§±ðŸ§ŠðŸ§ŠðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 4 )
      , [ "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ“¦ðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 5 )
      , [ "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§±ðŸ§ŠðŸ§Š"
        , "ðŸ“¦ðŸ§ŠðŸ“¦ðŸ§ŠðŸ“¦"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 6 )
      , [ "ðŸ“¦ðŸ§ŠðŸ§ŠðŸ§ŠðŸ“¦"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§±ðŸ“¦ðŸ§±ðŸ§Š"
        , "ðŸ§ŠðŸ“¦ðŸ§ŠðŸ“¦ðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 7 )
      , [ "ðŸ§ŠðŸ§ŠðŸ§±ðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§¨ðŸ§ŠðŸ§¨ðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 8 )
      , [ "ðŸ§ŠðŸ§ŠðŸ§±ðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ“¦ðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ“¦ðŸ§¨ðŸ“¦ðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 9 )
      , [ "ðŸ§ŠðŸ§ŠðŸ§±ðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ“¦ðŸ§ŠðŸ“¦ðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§¨ðŸ§ŠðŸ§Š"
        , "ðŸ§ŠðŸ“¦ðŸ§¨ðŸ“¦ðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 10 )
      , [ "ðŸ§ŠðŸ§Šâ¬œðŸ§ŠðŸ§Š"
        , "ðŸ§Šâ¬œðŸ§Šâ¬œðŸ§Š"
        , "ðŸ§ŠðŸ”‘ðŸ§ŠðŸ§Šâ¬œ"
        , "ðŸ§Šâ¬œðŸ§Šâ¬œðŸ§Š"
        , "ðŸ§ŠðŸ§ŠðŸ§ŠðŸ§ŠðŸ§Š"
        ]
            |> Game.Build.fromEmojis
      )
    ]


lavaLevels : ( Int, Int ) -> List ( ( Int, Int ), Dict ( Int, Int ) BuildingBlock )
lavaLevels ( x, y ) =
    [ ( ( x, y )
      , [ "â¬œâ¬œâ¬œâŒâŒ"
        , "â¬œâ¬œâŒâŒâŒ"
        , "â¬œâ¬œðŸ“¦â¬œâ¬œ"
        , "âŒâŒâŒâ¬œâ¬œ"
        , "âŒâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 1 )
      , [ "âŒâ¬œâ¬œâ¬œâŒ"
        , "âŒâ¬œðŸ“¦â¬œâŒ"
        , "âŒâŒâŒâŒâŒ"
        , "âŒâ¬œðŸ“¦â¬œâŒ"
        , "âŒâ¬œâ¬œâ¬œâŒ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 2 )
      , [ "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "âŒðŸ“¦âŒðŸ“¦âŒ"
        , "âŒâŒâŒâŒâŒ"
        , "â¬œðŸ“¦ðŸ“¦ðŸ“¦â¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 3 )
      , [ "âŒâ¬œâŒâ¬œâŒ"
        , "âŒâ¬œâŒâ¬œâŒ"
        , "ðŸ“¦ðŸ“¦ðŸ§±ðŸ“¦ðŸ“¦"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 4 )
      , [ "âŒðŸ“¦âŒðŸ“¦âŒ"
        , "ðŸ§¨ðŸ§±ðŸ§±ðŸ§±ðŸ§¨"
        , "ðŸ§±âŒðŸ“¦âŒðŸ§±"
        , "â¬œðŸ“¦ðŸ§¨ðŸ“¦â¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 5 )
      , [ "â¬œâ¬œâŒâ¬œâ¬œ"
        , "ðŸ“¦ðŸ§±ðŸ§±ðŸ§±ðŸ“¦"
        , "âŒðŸ§¨ðŸ“¦ðŸ§¨âŒ"
        , "âŒðŸ“¦ðŸ§¨ðŸ“¦âŒ"
        , "âŒâ¬œâ¬œâ¬œâŒ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 6 )
      , [ "âŒâŒâŒðŸ“¦âŒ"
        , "âŒâŒâŒâŒðŸ“¦"
        , "â¬œðŸ“¦â¬œâ¬œâŒ"
        , "â¬œðŸ“¦â¬œðŸ§¨â¬œ"
        , "â¬œðŸ“¦â¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 7 )
      , [ "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "â¬œâŒâ¬œâŒâ¬œ"
        , "â¬œâŒðŸ”‘âŒâ¬œ"
        , "â¬œâŒâŒâŒâ¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    ]


sokoBombLevels : ( Int, Int ) -> List ( ( Int, Int ), Dict ( Int, Int ) BuildingBlock )
sokoBombLevels ( x, y ) =
    [ ( ( x, y )
      , [ "ðŸ§±ðŸ“¦â¬œðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œðŸ“¦â¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 1 )
      , [ "ðŸ§±ðŸ“¦â¬œðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±ðŸ“¦ðŸ“¦ðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 2 )
      , [ "ðŸ§±â¬œðŸ“¦â¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±ðŸ“¦â¬œðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œðŸ“¦â¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 3 )
      , [ "ðŸ§±ðŸ“¦ðŸ“¦ðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ§¨â¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 4 )
      , [ "ðŸ§±â¬œðŸ“¦â¬œðŸ§±"
        , "ðŸ§±ðŸ“¦ðŸ“¦ðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œðŸ§¨â¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 5 )
      , [ "ðŸ§±ðŸ“¦ðŸ“¦ðŸ“¦ðŸ§±"
        , "ðŸ§±ðŸ“¦ðŸ§¨ðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œðŸ§¨â¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 6 )
      , [ "ðŸ§±ðŸ§±ðŸ§±ðŸ§±ðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ§¨â¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 7 )
      , [ "ðŸ§±ðŸ§±ðŸ§±ðŸ§±ðŸ§±"
        , "ðŸ§±ðŸ“¦ðŸ“¦ðŸ“¦ðŸ§±"
        , "ðŸ§±ðŸ§¨ðŸ§¨ðŸ§¨ðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 8 )
      , [ "ðŸ§±ðŸ§±ðŸ§±ðŸ§±ðŸ§±"
        , "ðŸ§±ðŸ§¨ðŸ“¦ðŸ§¨ðŸ§±"
        , "ðŸ§±ðŸ“¦ðŸ§¨ðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 9 )
      , [ "ðŸ§±â¬œðŸ“¦â¬œðŸ§±"
        , "ðŸ§¨â¬œâ¬œâ¬œðŸ§¨"
        , "ðŸ§±ðŸ“¦ðŸ“¦ðŸ“¦ðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 10 )
      , [ "ðŸ§±â¬œðŸ“¦â¬œðŸ§±"
        , "ðŸ§¨ðŸ“¦â¬œðŸ“¦ðŸ§¨"
        , "ðŸ§¨â¬œðŸ“¦â¬œðŸ§¨"
        , "ðŸ§¨ðŸ“¦ðŸ“¦ðŸ“¦ðŸ§¨"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 11 )
      , [ "ðŸ§±â¬œðŸ§±â¬œðŸ§±"
        , "ðŸ§¨ðŸ§±ðŸ“¦ðŸ§±ðŸ§¨"
        , "ðŸ§¨ðŸ“¦ðŸ§¨ðŸ“¦ðŸ§¨"
        , "ðŸ§¨â¬œðŸ§¨â¬œðŸ§¨"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 12 )
      , [ "ðŸ§±ðŸ§±ðŸ§±ðŸ§±ðŸ§±"
        , "ðŸ§±â¬œðŸ§¨â¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œâ¬œâ¬œðŸ§±"
        , "ðŸ§±â¬œðŸ˜Šâ¬œðŸ§±"
        ]
            |> Game.Build.fromEmojis
      )
    , ( ( x, y - 13 )
      , [ "â¬œâ¬œâ¬œâ¬œâ¬œ"
        , "â¬œðŸ§±â¬œðŸ§±â¬œ"
        , "â¬œðŸ§±ðŸ”‘ðŸ§±â¬œ"
        , "â¬œðŸ§±ðŸ§±ðŸ§±â¬œ"
        , "â¬œâ¬œâ¬œâ¬œâ¬œ"
        ]
            |> Game.Build.fromEmojis
      )
    ]
